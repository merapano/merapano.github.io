---
title: "ssh が外から通じない"
author: Satoshi Nakagawa
category: Linux

---

[2015-05-13]  2月と同じ症状が出た---
学校の中にあるサーバーへ、
学校の外から ssh がアクセスできないのだ。
学内のコンピュータからはアクセスできる。

 外側のコンピュータ三台から
同時にアクセスが不能になったので、
クライアント側の問題とは思えない。

 前回（今年の2月）は、
学校全体の問題、
サーバーのある建物（サブネット）を
「外からアクセス可能なもの」として
登録していなかったという問題だった。
今回は `ssh -v` で見るかぎり、
サーバーのもとにまでは
達している
（`Connection established` というメッセージが
出るのだ）。

 そうすると `hosts.allow/deny` の
問題だと考えるべきなのだが、
これらをいじった覚えはない。

 コンピュータ室のスーパーマン
（Ｏ先生）にメールで相談する。
(1) DNS の問題か、
(2) （クライアント側の）
`.ssh/` 以下のパーミッションの問題では
ないかという、返事が帰ってきた。

 クライアントの問題（(2)）ではないだろうな、
しかし DNS が、
SSH のアクセスの問題にどのように
関わってくるのか分からない。

 ここで、突然アイデアが浮かぶ。
数日前から http (apache2) のアクセスログが
ホスト名ではなく、
IP の番号で記載されるようになっていたことを
思い出す。
その時点から DNS が働いてない、ということだろう。
さて、
ぼくの `hosts.allow` は、
学内とぼくが家から使うプロバイダーとを
許可するように設定してある。
そして学内は IP で指定しているのだが、
それ以外はホスト名での指定だ。

 「エウレカ！」

 DNS として学部のものだけを登録してあったのだが、
［--おそらく、この DNS が不調になったのだろう--］
さらに大学が用意している DNS を追加登録した。
こうした上で、
スマートフォンを使って（LTE 経由で）
サーバーにアクセスしてみる。

 莞爾（にっこり）・・・

 通じました。

 _hosts.allow_' を
IP での記入に変更しておこう。

 謎が解けて、そして ssh が
通じて、
感極まっていたところに
タイミングよく MY (OB)くんがやってきた。
彼にこの感動を伝えようと思ったのだが・・・

 無理だった。

 だれも分かってくれない・・・

- Category: [Linux](categories.html#Linux)

